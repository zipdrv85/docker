# docker-compose.yml

version: "3"

services:
  edm-app-1: # 서비스명
    #image: zipdrv/edm60:6.1.0.1 # 이미지, 태그
    build:
      context: ../edm/
      dockerfile: Dockerfile
    ports:
      - "7180:7080"
    volumes:
      - /docker/service/postEdmHA/data:/app/xedrm60/data
    env_file:
      - ../edm/edm.postgres.env
    depends_on:
      - db
  edm-app2-1: # 서비스명
    #image: zipdrv/edm60:6.1.0.1 # 이미지, 태그
    build:
      context: ../edm/
      dockerfile: Dockerfile
    ports:
      - "7184:7080"
    env_file:
      - ../edm/edm.postgres.env
    volumes:
      - /docker/service/postEdmHA/data:/app/xedrm60/data
    depends_on:
      - db
  db:
      #image: jaspeen/oracle-11g
      #image: jaspeen/oracle-xe-11g
      build:
        context: ../db/oracle/
        dockerfile: Dockerfile
      container_name: oracleHA-database
      restart: always 
      env_file:
        - ../edm/edm.oracle.env
      volumes:
        - oraclexe11gHA:/u01/app/oracle
        - ../db/oracle/script:/docker-entrypoint-initdb.d
      ports:
        - "7190:1521"
  nginx:
    image: nginx
    ports:
      - "7183:80"
    volumes:
      - ../nginx/nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - db

volumes:
  oraclexe11gHA:
    #driver: local
    #driver_opts:
      #type: none
      #device: /docker/db/postgres13/data
      #o: bind
